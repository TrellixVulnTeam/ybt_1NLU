ExtDockerImage(
    'ubuntu',
    image='ubuntu',
    tag='16.04'
)

DockerImage(
    'build-run-base',
    start_from=':ubuntu',
    deps='//3rdparty:upgrade-pip'
)

Proto(
    'hello',
    in_buildenv=':flask-hello',
    sources='hello.proto',
    output_dir='out'

)

Python(
    'flask-hello-app',
    sources='app.py',
    deps='//3rdparty:flask'
)

DockerImage(
    'flask-hello',
    start_from=':build-run-base',
    env = {
        'PYTHONPATH': '.:./yabtwork',
    },
    deps = ['//3rdparty:protobuf',':flask-hello-app'],
    docker_cmd = ['python', 'app/app.py']
)
